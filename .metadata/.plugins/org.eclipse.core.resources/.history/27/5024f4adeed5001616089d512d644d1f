# -*- coding: utf-8 -*-
'''
Created on 7 Oca 2017

@author: Purgoufr
'''
#----Provider---                   ---SMTP server domain name---
# Gmail                               imap.gmail.com
# 
# Outlook.com/Hotmail.com             imap-mail.outlook.com
# 
# Yahoo Mail                          imap.mail.yahoo.com
# 
# AT&T                                imap.mail.att.net
# 
# Comcast                             imap.comcast.net
# 
# Verizon                             incoming.verizon.net
# 
# import imapclient
#  
# imapObj=imapclient.IMAPClient('imap.mail.yahoo.com',ssl=True)
#  
# print('Enter your mail adress')
# mail = input()
#   
# print('Enter your password')
# password = input()
#   
# imapObj.login(' %s ' % (mail), ' %s ' % (password))
 
 
# imapObj.list_folders()           #dosyalari listele


import imapclient, pyzmail
 
socks.setdefaultproxy(socks.PROXY_TYPE_SOCKS4,"10.3.100.207",8080,True)
socket.socket = socks.socksocket

imapObj = imapclient.IMAPClient('imap.gmail.com',ssl=True)
imapObj.login('***********@gmail.com','*********')
imapObj.select_folder('INBOX', readonly=True)

UIDs = imapObj.search(['SINCE 07-Jul-2016'])

for item in UIDs:
    rawMessages = imapObj.fetch(item, ['BODY[]', 'FLAGS'])
    message = pyzmail.PyzMessage.factory(rawMessages[item]['BODY[]'])
    message.get_subject()
    message.get_addresses('from')
    message.get_addresses('to')
    message.get_addresses('cc')
    message.get_addresses('bcc')
    message.text_part != None
    message.text_part.get_payload().decode(message.text_part.charset)
    message.html_part != None
    message.html_part.get_payload().decode(message.html_part.charset)
imapObj.logout()






